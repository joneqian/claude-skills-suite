# Process FAQ - RAG 知识库优化工具

将原始 FAQ 文档转换为 RAG 优化的知识库格式，通过 **Claude 智能内容扩展** 和 **脚本自动标准化** 的协作完成。

## 核心价值

将小型 FAQ（7条）扩展为全面知识库（31条），每个问题更具体、每个答案更简洁，完美适配 RAG 系统。

**与传统工具的区别**:
- ❌ 传统工具: 只做格式转换和关键词提取（7条 → 5条去重）
- ✅ 本工具: Claude 理解内容并扩展（7条 → 31条精准FAQ）

## 核心特性

- **智能内容扩展**: Claude 从长回答中提取独立知识点，创建专注的 FAQ
- **知识点拆分**: 一个500字回答 → 5-10个简洁的独立问答
- **自动关键词**: 使用 jieba TF-IDF 自动生成搜索关键词
- **专业格式化**: 统一的 Excel 样式，列宽、字体、对齐
- **多格式支持**: Excel、Word、PDF、TXT 全支持
- **质量检查**: 最终去重、格式验证

## 工作流程（3步协作）

```
原始文件.xlsx (7条 FAQ，每条回答很长)
    ↓
    [Step 1: 脚本转换]
    ↓
Markdown 文件 (便于 Claude 阅读)
    ↓
    [Step 2: Claude 分析和扩展 - 关键步骤！]
    ↓
扩展版.xlsx (31条 FAQ，每条简洁专注)
    ↓
    [Step 3: 脚本标准化]
    ↓
RAG优化版.xlsx (含关键词、专业格式)
```

### 分工明确

**Claude 负责（创造性工作）**:
- 理解业务场景和领域知识
- 识别长回答中的多个知识点
- 拆分复杂问题为具体问题
- 重写答案使其简洁专注
- 设计清晰的分类结构

**脚本负责（机械性工作）**:
- Markdown 格式转换
- jieba 关键词自动生成
- Excel 格式和样式标准化
- 最终去重和质检

## 详细步骤

### Step 1: 转换为 Markdown

```bash
python process-faq/scripts/convert_to_markdown.py 申花太赫兹知识库.xlsx
```

**输出**: `申花太赫兹知识库_for_analysis.md`

### Step 2: Claude 分析和扩展（核心步骤）

Claude 读取 Markdown 文件并执行:

1. **分析原始内容**
   - 识别长回答（500+字）
   - 发现每个回答包含多个主题
   - 例如："你们是怎么调理睡眠的"回答中包含：产品原理、购买政策、设备说明、使用方法等

2. **提取知识点**
   - 从每个长回答中提取独立主题
   - 为每个知识点创建独立问题

3. **重写答案**
   - 每个答案聚焦一个主题
   - 简洁明确（50-200字）
   - 去除冗余信息

4. **生成扩展文件**
   使用 pandas 创建 `申花太赫兹知识库_expanded.xlsx`:
   ```python
   import pandas as pd

   data = [
       {'分类': '睡眠问题咨询', '问题': '你们是怎么调理睡眠的？', '回答': '我们通过太赫兹能量睡垫来调理...'},
       {'分类': '睡眠问题咨询', '问题': '我总是入睡困难怎么办？', '回答': '入睡困难通常和气血不畅...'},
       {'分类': '产品政策', '问题': '什么是先用后付？', '回答': '先用后付就是您可以先把产品拿回家...'},
       # ... 更多扩展后的 FAQ
   ]

   df = pd.DataFrame(data)
   df.to_excel('申花太赫兹知识库_expanded.xlsx', index=False)
   ```

### Step 3: 标准化格式

```bash
python process-faq/scripts/generate_rag_faq.py 申花太赫兹知识库_expanded.xlsx 申花太赫兹知识库_RAG_优化版.xlsx
```

脚本自动完成:
- ✓ 使用 jieba 生成关键词
- ✓ 应用专业 Excel 格式
- ✓ 设置列宽和样式
- ✓ 最终去重检查

## 输出格式

| 分类 | 问题 | 回答 | 关键词 |
|------|------|------|--------|
| 睡眠问题咨询 | 你们是怎么调理睡眠的？ | 我们通过太赫兹能量睡垫... | 睡眠,调理,太赫兹,气血 |
| 产品政策 | 什么是先用后付？ | 先用后付就是您可以... | 先用后付,免费体验,无风险 |

## 安装

```bash
pip install -r process-faq/requirements.txt
```

或单独安装:
```bash
pip install pandas openpyxl python-docx PyPDF2 jieba
```

## 真实案例

### 输入
**申花太赫兹知识库.xlsx** - 7条FAQ，每条回答500+字

| 问题 | 回答（部分） |
|------|-------------|
| 你们是怎么调理睡眠的 | [500字长回答，包含：调理原理、购买政策、手环说明、使用方法...] |
| 先用后付是什么意思 | [与上一条相同的500字回答] |
| ... | ... |

### Claude 扩展后
**申花太赫兹知识库_expanded.xlsx** - 31条FAQ，每条简洁专注

分为8个类别：
- 睡眠问题咨询（4条）
- 产品政策（4条）
- 设备相关（3条）
- 使用指南（5条）
- 数据解读（2条）
- 效果评估（2条）
- 咨询服务（2条）
- ...

### 脚本标准化后
**申花太赫兹知识库_RAG_优化版.xlsx** - 31条，含关键词和专业格式

## 为什么这样设计？

### 方案对比

| 维度 | 纯脚本方案 | 本工具（Claude+脚本） |
|------|-----------|-------------------|
| 内容理解 | ❌ 无法理解业务 | ✅ Claude 理解领域知识 |
| 内容扩展 | ❌ 只能去重（7→5） | ✅ 智能扩展（7→31） |
| 问题拆分 | ❌ 无法拆分 | ✅ 从长回答提取知识点 |
| 分类准确性 | ⚠️ 关键词匹配（不准） | ✅ 理解场景后分类 |
| 关键词质量 | ✅ jieba TF-IDF | ✅ jieba TF-IDF（相同） |
| 格式标准化 | ✅ Excel 格式化 | ✅ Excel 格式化（相同） |

### 核心优势

**Claude 的不可替代性**：
- 理解"太赫兹睡眠调理"这个垂直领域
- 识别一个500字回答包含5个不同话题
- 为每个话题创建独立问题和答案
- 这是脚本永远无法做到的

**脚本的价值**：
- 批量处理关键词提取
- 标准化 Excel 格式
- 确保输出一致性

## 最佳实践

1. **专注内容扩展**: 你的核心价值是扩展内容，不是格式化
2. **拆分长回答**: 超过300字的回答通常包含多个主题，应该拆分
3. **每个FAQ聚焦**: 一个问题 = 一个主题，答案50-200字最佳
4. **不要手写关键词**: 让脚本用 jieba 自动生成，更客观一致
5. **检查扩展质量**: 确保没有遗漏原始内容中的任何知识点

## 支持的文件格式

- **Excel (.xlsx)**: 最推荐，结构化数据
- **Word (.docx)**: 段落文本，自动识别 Q&A 格式
- **PDF (.pdf)**: 提取文本内容（文本型PDF效果最好）
- **Text (.txt)**: 纯文本，UTF-8 编码

## 常见问题

**Q: 为什么不能直接处理原始文件？**
A: 需要先转 Markdown，这样 Claude 才能阅读和理解内容。

**Q: 关键词必须手动生成吗？**
A: 不需要！脚本会自动用 jieba 生成，更客观一致。

**Q: 如何判断扩展是否成功？**
A: 检查：1) 每个问题具体明确 2) 每个答案简洁专注 3) 所有知识点都覆盖

**Q: 原始FAQ只有5条能扩展吗？**
A: 可以！如果每条回答很长，可能扩展为15-30条精准FAQ。

## 文件结构

```
process-faq/
├── skill.md                   # Skill 定义
├── README.md                  # 本文件
├── requirements.txt           # Python 依赖
└── scripts/
    ├── convert_to_markdown.py    # 转换为 Markdown
    └── generate_rag_faq.py       # RAG 标准化
```

## 版本

当前版本: 3.0.0 (Claude + Script 协作模式)

### 3.0 新特性
- ✅ Claude 负责内容扩展（创造性工作）
- ✅ 脚本负责格式标准化（机械性工作）
- ✅ 明确分工，发挥各自优势
- ✅ 7条 FAQ → 31条 精准知识库
- ⚠️ 2.0 版本问题：脚本无法理解内容，只能去重

## License

MIT License
